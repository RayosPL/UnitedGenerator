<div class="col-auto">
    <div class="card m-1 @CardClass">
        <div class="card-header">
            @header
        </div>
        <div class="card-body">
            <span class="fw-bold">@Item?.Name</span>
            
            @if (ShowBoxInfo)
            {
                <br />
                <span class="fst-italic">@Item?.Box.Name</span>
            }
            
            @ChildContent
            
            @if (ShowDetails)
            {
                <br />
                <br />
                <BoxItemDetails Item="Item" />
            }
        </div>
    </div>
</div>

@code 
{
    private IBoxItem? _item;

    private string? header;

    private string? CardClass { get; set; }

    [Parameter]
    public bool ShowBoxInfo { get; set; } = true;

    [Parameter]
    public bool ShowDetails { get; set; } = false;

    [Parameter]
    public RenderFragment? ChildContent { get; set; }

    [Parameter]
    public IBoxItem? Item
    {
        get { return _item; }
        set
        {
            _item = value;

            if (value is IAntiHero)
            {
                header = "Anti Hero";
                CardClass = "bg-anti-hero";
            }
            else if(value is IHero)
            {
                header = "Hero";
                CardClass = "bg-hero";
            }
            else if (value is IVillain)
            {
                var villain = (IVillain)value;

                if (villain.IsVillainTeam)
                {
                    header = "Villain Team";
                    CardClass = "bg-villain-team";
                }
                else
                {
                    header = "Villain";
                    CardClass = "bg-villain";
                }
            }
            else if (value is ILocation)
            {
                header = "Location";
                CardClass = "bg-location";
            }
            else if(value is IHeroTeam)
            {
                var team = (IHeroTeam)value;

                header = $"Team ({team.TeamType})";
                CardClass = "bg-hero-team";
            }
            else if (value is IChallenge)
            {
                header = "Challenge";
                CardClass = "bg-challenge";
            }
        }
    }
}